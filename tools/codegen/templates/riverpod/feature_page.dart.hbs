import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:lumora_ui_tokens/lumora_ui_tokens.dart';
import '../providers/{{featureNameLower}}_provider.dart';

/// Page widget for the {{featureName}} feature using Riverpod.
/// 
/// This page provides the UI for the {{featureName}} feature and manages
/// its state using Riverpod's StateNotifier pattern. It automatically
/// watches for state changes and rebuilds when necessary.
class {{featureName}}Page extends ConsumerWidget {
  const {{featureName}}Page({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final state = ref.watch({{featureName}}Provider);
    final notifier = ref.read({{featureName}}Provider.notifier);

    return Scaffold(
      appBar: AppBar(
        title: const Text('{{featureTitle}}'),
      ),
      body: {{#if stateFields}}_buildContent(context, state, notifier){{else}}_buildAsyncContent(context, state, notifier){{/if}},
    );
  }

  {{#if stateFields}}
  /// Builds the main content of the page.
  Widget _buildContent(
    BuildContext context,
    {{featureName}}State state,
    {{featureName}}Notifier notifier,
  ) {
    return {{{widgetCode}}};
  }
  {{else}}
  /// Builds content based on async state (loading, data, error).
  Widget _buildAsyncContent(
    BuildContext context,
    AsyncValue<void> state,
    {{featureName}}Notifier notifier,
  ) {
    return state.when(
      data: (_) => _buildContent(context, notifier),
      loading: () => const Center(
        child: CircularProgressIndicator(),
      ),
      error: (error, stack) => Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Icon(
              Icons.error_outline,
              color: LumoraColors.error,
              size: 48,
            ),
            const SizedBox(height: 16),
            Text(
              'Error: $error',
              style: LumoraTypography.bodyMedium.copyWith(
                color: LumoraColors.error,
              ),
              textAlign: TextAlign.center,
            ),
          ],
        ),
      ),
    );
  }

  /// Builds the main content of the page when data is loaded.
  Widget _buildContent(BuildContext context, {{featureName}}Notifier notifier) {
    return {{{widgetCode}}};
  }
  {{/if}}
}
